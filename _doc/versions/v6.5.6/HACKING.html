<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Hacking OfflineIMAP &mdash; OfflineImap 6.5.6.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '6.5.6.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="OfflineImap 6.5.6.1 documentation" href="index.html" />
    <link rel="next" title="offlineimap&#39;s API documentation" href="API.html" />
    <link rel="prev" title="1   OfflineIMAP FAQ (Frequently Asked Questions)" href="FAQ.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="API.html" title="offlineimap&#39;s API documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="FAQ.html" title="1   OfflineIMAP FAQ (Frequently Asked Questions)"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">OfflineImap 6.5.6.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="hacking-offlineimap">
<h1><a class="toc-backref" href="#id1">Hacking OfflineIMAP</a><a class="headerlink" href="#hacking-offlineimap" title="Permalink to this headline">¶</a></h1>
<p>In this section you&#8217;ll find all the information you need to start
hacking <a class="reference external" href="http://offlineimap.org">OfflineIMAP</a>. Be aware there are a lot of very usefull tips
in the mailing list.  You may want to subscribe if you didn&#8217;t,
yet. This is where you will get help.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#hacking-offlineimap" id="id1">Hacking OfflineIMAP</a><ul>
<li><a class="reference internal" href="#api" id="id2">API</a></li>
<li><a class="reference internal" href="#following-new-commits" id="id3">Following new commits</a></li>
</ul>
</li>
<li><a class="reference internal" href="#git-offlineimap-s-branching-model-and-workflow" id="id4">Git: OfflineImap&#8217;s branching Model And Workflow</a><ul>
<li><a class="reference internal" href="#introduction" id="id5">Introduction</a></li>
<li><a class="reference internal" href="#git-branching-model" id="id6">Git Branching model</a></li>
<li><a class="reference internal" href="#release-cycles" id="id7">Release cycles</a></li>
<li><a class="reference internal" href="#tagging-release-or-rc" id="id8">Tagging release or RC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#contribution-checklist-and-a-short-version-for-the-impatient" id="id9">Contribution Checklist (and a short version for the impatient)</a><ul>
<li><a class="reference internal" href="#create-commits" id="id10">Create commits</a></li>
<li><a class="reference internal" href="#export-commits-as-patches" id="id11">Export commits as patches</a></li>
<li><a class="reference internal" href="#long-version" id="id12">Long version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#an-ideal-patch-flow" id="id13">An ideal patch flow</a><ul>
<li><a class="reference internal" href="#know-the-status-of-your-patch-after-submission" id="id14">Know the status of your patch after submission</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mua-specific-hints" id="id15">MUA specific hints</a><ul>
<li><a class="reference internal" href="#pine" id="id16">Pine</a></li>
<li><a class="reference internal" href="#thunderbird" id="id17">Thunderbird</a></li>
<li><a class="reference internal" href="#gnus" id="id18">Gnus</a></li>
<li><a class="reference internal" href="#kmail" id="id19">KMail</a></li>
<li><a class="reference internal" href="#gmail" id="id20">Gmail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-git" id="id21">Working with Git</a><ul>
<li><a class="reference internal" href="#extract-a-topic-from-pu" id="id22">Extract a topic from pu</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="api">
<h2><a class="toc-backref" href="#id2">API</a><a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="API.html#api-docs"><em>OfflineImap&#8217;s API</em></a> documentation is included in the user
documentation (next section) and online browsable at
<a class="reference external" href="http://docs.offlineimap.org">http://docs.offlineimap.org</a>. It is mostly auto-generated from the
source code and is a work in progress. Contributions in this area
would be very appreciated.</p>
</div>
<div class="section" id="following-new-commits">
<h2><a class="toc-backref" href="#id3">Following new commits</a><a class="headerlink" href="#following-new-commits" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>You can follow upstream commits on</dt>
<dd><ul class="first last simple">
<li><cite>CIA.vc &lt;http://cia.vc/stats/project/offlineimap&gt;</cite>,</li>
<li><cite>Ohloh &lt;http://www.ohloh.net/p/offlineimap&gt;</cite>,</li>
<li><cite>GitHub &lt;https://github.com/spaetz/offlineimap/commits/&gt;</cite>,</li>
<li>or on the <a class="reference external" href="http://lists.offlineimap.org/listinfo.cgi/commits-offlineimap.org">commits mailing list</a>.</li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="git-offlineimap-s-branching-model-and-workflow">
<h1><a class="toc-backref" href="#id4">Git: OfflineImap&#8217;s branching Model And Workflow</a><a class="headerlink" href="#git-offlineimap-s-branching-model-and-workflow" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id5">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This optional section provides you with information on how we use git
branches and do releases. You will need to know very little about git
to get started.</p>
<p>For the impatient, see the <a class="reference internal" href="#contribution-checklist"><em>Contribution Checklist (and a short version for the impatient)</em></a> below.</p>
</div>
<div class="section" id="git-branching-model">
<h2><a class="toc-backref" href="#id6">Git Branching model</a><a class="headerlink" href="#git-branching-model" title="Permalink to this headline">¶</a></h2>
<p>OfflineIMAP uses the following branches:</p>
<blockquote>
<div><ul class="simple">
<li>master</li>
<li>next</li>
<li>maint</li>
<li>(pu)</li>
<li>&amp; several topic oriented feature branches. A topic may consist of
one or more patches.</li>
</ul>
</div></blockquote>
<div class="section" id="master">
<h3>master<a class="headerlink" href="#master" title="Permalink to this headline">¶</a></h3>
<p>If you&#8217;re not sure what branch you should use, this one is for you.
This is the mainline. Simple users should use this branch to follow
OfflineIMAP&#8217;s evolution.</p>
<p>Usually, patches submitted to the mailing list should start off of
this branch.</p>
</div>
<div class="section" id="next">
<h3>next<a class="headerlink" href="#next" title="Permalink to this headline">¶</a></h3>
<p>Patches recently merged are good candidates for this branch. The content of next
is merged into the mainline (master) at release time for both stable and -rc
releases.</p>
<p>When patches are sent to the mailing list, contributors discuss about them. Once
done and when patches looks ready for mainline, patches are first merged into
next. Advanced users and testers use this branch to test last merged patches
before they hit the mainline. This helps not introducing strong breackages
directly in master.</p>
</div>
<div class="section" id="pu">
<h3>pu<a class="headerlink" href="#pu" title="Permalink to this headline">¶</a></h3>
<p>pu stands for &#8220;proposed updates&#8221;. If a topic is not ready for master nor next,
it may be merged into pu. This branch only help developers to work on someone
else topic or an earlier pending topic.</p>
<p>This branch is <strong>not intended to be checkouted</strong>; never. Even developers don&#8217;t
do that. Due to the way pu is built you can&#8217;t expect content there to work in
any way... unless you clearly want to run into troubles.</p>
<p>Developers can extract a topic from this branch to work on it. See the following
section &#8220;Extract a topic from pu&#8221; in this documentation.</p>
</div>
<div class="section" id="maint">
<h3>maint<a class="headerlink" href="#maint" title="Permalink to this headline">¶</a></h3>
<p>This is the maintenance branch. It gets its own releases starting from an old
stable release. It helps both users having troubles with last stable releases
and users not wanting latest features or so to still benefit from strong bug
fixes and security fixes.</p>
</div>
</div>
<div class="section" id="release-cycles">
<h2><a class="toc-backref" href="#id7">Release cycles</a><a class="headerlink" href="#release-cycles" title="Permalink to this headline">¶</a></h2>
<p>A typical release cycle works like this:</p>
<ol class="arabic simple">
<li>A stable release is out.</li>
<li>Feature topics are sent, discussed and merged.</li>
<li>When enough work was merged, we start the freeze cycle: the first release
candidate is out.</li>
<li>During the freeze cycle, no more features are merged. It&#8217;s time to test
OfflineIMAP. New candidates version are released. The more we are late in -rc
releases the less patches are merged but bug fixes.</li>
<li>When we think a release is stable enough, we restart from step 1.</li>
</ol>
</div>
<div class="section" id="tagging-release-or-rc">
<h2><a class="toc-backref" href="#id8">Tagging release or RC</a><a class="headerlink" href="#tagging-release-or-rc" title="Permalink to this headline">¶</a></h2>
<p>It is done via Git&#8217;s <tt class="docutils literal"><span class="pre">tag</span></tt> command, but you must do <tt class="docutils literal"><span class="pre">git</span> <span class="pre">tag</span> <span class="pre">-a</span></tt>
to create annotated tag.</p>
<p>Release tags are named <tt class="docutils literal"><span class="pre">vX.Y.Z</span></tt> and release candidate tags are named
<tt class="docutils literal"><span class="pre">vX.Y.Z-rcN</span></tt>.</p>
</div>
</div>
<div class="section" id="contribution-checklist-and-a-short-version-for-the-impatient">
<span id="contribution-checklist"></span><h1><a class="toc-backref" href="#id9">Contribution Checklist (and a short version for the impatient)</a><a class="headerlink" href="#contribution-checklist-and-a-short-version-for-the-impatient" title="Permalink to this headline">¶</a></h1>
<div class="section" id="create-commits">
<h2><a class="toc-backref" href="#id10">Create commits</a><a class="headerlink" href="#create-commits" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">make commits of logical units</p>
</li>
<li><p class="first">check for unnecessary whitespace with <tt class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span> <span class="pre">--check</span></tt>
before committing</p>
</li>
<li><p class="first">do not check in commented out code or unneeded files</p>
</li>
<li><p class="first">the first line of the commit message should be a short
description (50 characters is the soft limit, see DISCUSSION
in git-commit(1)), and should skip the full stop</p>
</li>
<li><dl class="first docutils">
<dt>the body should provide a meaningful commit message, which:</dt>
<dd><ul class="first last simple">
<li>uses the imperative, present tense: <strong>change</strong>,
not <strong>changed</strong> or <strong>changes</strong>.</li>
<li>includes motivation for the change, and contrasts
its implementation with previous behaviour</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">add a <tt class="docutils literal"><span class="pre">Signed-off-by:</span> <span class="pre">Your</span> <span class="pre">Name</span> <span class="pre">&lt;you&#64;example.com&gt;</span></tt> line to the
commit message (or just use the option <cite>-s</cite> when committing)
to confirm that you agree to the <strong>Developer&#8217;s Certificate of Origin</strong></p>
</li>
<li><p class="first">make sure that you have tests for the bug you are fixing</p>
</li>
<li><p class="first">make sure that the test suite passes after your commit</p>
</li>
</ul>
</div>
<div class="section" id="export-commits-as-patches">
<h2><a class="toc-backref" href="#id11">Export commits as patches</a><a class="headerlink" href="#export-commits-as-patches" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>use <tt class="docutils literal"><span class="pre">git</span> <span class="pre">format-patch</span> <span class="pre">-M</span></tt> to create the patch</li>
<li>do not PGP sign your patch</li>
<li>do not attach your patch, but read in the mail
body, unless you cannot teach your mailer to
leave the formatting of the patch alone.</li>
<li>be careful doing cut &amp; paste into your mailer, not to
corrupt whitespaces.</li>
<li>provide additional information (which is unsuitable for
the commit message) between the <tt class="docutils literal"><span class="pre">---</span></tt> and the diffstat</li>
<li>if you change, add, or remove a command line option or
make some other user interface change, the associated
documentation should be updated as well.</li>
<li>if your name is not writable in ASCII, make sure that
you send off a message in the correct encoding.</li>
<li>send the patch to the <a class="reference external" href="http://lists.alioth.debian.org/mailman/listinfo/offlineimap-project">mailing list</a> and the
maintainer (<a class="reference external" href="mailto:nicolas&#46;s-dev&#37;&#52;&#48;laposte&#46;net">nicolas<span>&#46;</span>s-dev<span>&#64;</span>laposte<span>&#46;</span>net</a>) if (and only if)
the patch is ready for inclusion. If you use <cite>git-send-email(1)</cite>,
please test it first by sending email to yourself.</li>
<li>see below for instructions specific to your mailer</li>
</ul>
</div>
<div class="section" id="long-version">
<h2><a class="toc-backref" href="#id12">Long version</a><a class="headerlink" href="#long-version" title="Permalink to this headline">¶</a></h2>
<p>I started reading over the SubmittingPatches document for Git, primarily because
I wanted to have a document similar to it for OfflineIMAP to make sure people
understand what they are doing when they write <cite>Signed-off-by</cite> line.</p>
<p>But the patch submission requirements are a lot more relaxed here on the
technical/contents front, because the OfflineIMAP is a lot smaller ;-).  So here
is only the relevant bits.</p>
<div class="section" id="decide-what-branch-to-base-your-work-on">
<h3>Decide what branch to base your work on<a class="headerlink" href="#decide-what-branch-to-base-your-work-on" title="Permalink to this headline">¶</a></h3>
<p>In general, always base your work on the oldest branch that your
change is relevant to.</p>
<ul class="simple">
<li>A bugfix should be based on &#8216;maint&#8217; in general. If the bug is not
present in &#8216;maint&#8217;, base it on &#8216;master&#8217;. For a bug that&#8217;s not yet
in &#8216;master&#8217;, find the topic that introduces the regression, and
base your work on the tip of the topic.</li>
<li>A new feature should be based on &#8216;master&#8217; in general. If the new
feature depends on a topic that is in &#8216;pu&#8217;, but not in &#8216;master&#8217;,
base your work on the tip of that topic.</li>
<li>Corrections and enhancements to a topic not yet in &#8216;master&#8217; should
be based on the tip of that topic. If the topic has not been merged
to &#8216;next&#8217;, it&#8217;s alright to add a note to squash minor corrections
into the series.</li>
<li>In the exceptional case that a new feature depends on several topics
not in &#8216;master&#8217;, start working on &#8216;next&#8217; or &#8216;pu&#8217; privately and send
out patches for discussion. Before the final merge, you may have to
wait until some of the dependent topics graduate to &#8216;master&#8217;, and
rebase your work.</li>
</ul>
<p>To find the tip of a topic branch, run <tt class="docutils literal"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">--first-parent</span>
<span class="pre">master..pu</span></tt> and look for the merge commit. The second parent of this
commit is the tip of the topic branch.</p>
</div>
<div class="section" id="make-separate-commits-for-logically-separate-changes">
<h3>Make separate commits for logically separate changes<a class="headerlink" href="#make-separate-commits-for-logically-separate-changes" title="Permalink to this headline">¶</a></h3>
<p>Unless your patch is really trivial, you should not be sending your
changes in a single patch.  Instead, always make a commit with
complete commit message and generate a series of small patches from
your repository.</p>
<p>Describe the technical detail of the change(s).</p>
<p>If your description starts to get too long, that&#8217;s a sign that you
probably need to split up your commit to finer grained pieces.
That being said, patches which plainly describe the things that
help reviewers check the patch, and future maintainers understand
the code, are the most beautiful patches.  Descriptions that summarise
the point in the subject well, and describe the motivation for the
change, the approach taken by the change, and if relevant how this
differs substantially from the prior version, can be found on Usenet
archives back into the late 80&#8217;s.  Consider it like good Netiquette,
but for code.</p>
</div>
<div class="section" id="generate-your-patch-using-git-tools-out-of-your-commits">
<h3>Generate your patch using git tools out of your commits<a class="headerlink" href="#generate-your-patch-using-git-tools-out-of-your-commits" title="Permalink to this headline">¶</a></h3>
<p>git based diff tools (git, Cogito, and StGIT included) generate
unidiff which is the preferred format.</p>
<p>You do not have to be afraid to use -M option to <tt class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></tt> or
<tt class="docutils literal"><span class="pre">git</span> <span class="pre">format-patch</span></tt>, if your patch involves file renames.  The
receiving end can handle them just fine.</p>
<p>Please make sure your patch does not include any extra files
which do not belong in a patch submission.  Make sure to review
your patch after generating it, to ensure accuracy.  Before
sending out, please make sure it cleanly applies to the &#8220;master&#8221;
branch head.  If you are preparing a work based on &#8220;next&#8221; branch,
that is fine, but please mark it as such.</p>
</div>
<div class="section" id="sending-your-patches">
<h3>Sending your patches<a class="headerlink" href="#sending-your-patches" title="Permalink to this headline">¶</a></h3>
<p>People on the mailing list need to be able to read and
comment on the changes you are submitting.  It is important for
a developer to be able to &#8220;quote&#8221; your changes, using standard
e-mail tools, so that they may comment on specific portions of
your code.  For this reason, all patches should be submitted
&#8220;inline&#8221;.  WARNING: Be wary of your MUAs word-wrap
corrupting your patch.  Do not cut-n-paste your patch; you can
lose tabs that way if you are not careful.</p>
<p>It is a common convention to prefix your subject line with
[PATCH].  This lets people easily distinguish patches from other
e-mail discussions.  Use of additional markers after PATCH and
the closing bracket to mark the nature of the patch is also
encouraged.  E.g. [PATCH/RFC] is often used when the patch is
not ready to be applied but it is for discussion, [PATCH v2],
[PATCH v3] etc. are often seen when you are sending an update to
what you have previously sent.</p>
<p><tt class="docutils literal"><span class="pre">git</span> <span class="pre">format-patch</span></tt> command follows the best current practice to
format the body of an e-mail message.  At the beginning of the
patch should come your commit message, ending with the
Signed-off-by: lines, and a line that consists of three dashes,
followed by the diffstat information and the patch itself.  If
you are forwarding a patch from somebody else, optionally, at
the beginning of the e-mail message just before the commit
message starts, you can put a &#8220;From: &#8221; line to name that person.</p>
<p>You often want to add additional explanation about the patch,
other than the commit message itself.  Place such &#8220;cover letter&#8221;
material between the three dash lines and the diffstat.</p>
<p>Do not attach the patch as a MIME attachment, compressed or not.
Do not let your e-mail client send quoted-printable.  Do not let
your e-mail client send format=flowed which would destroy
whitespaces in your patches. Many
popular e-mail applications will not always transmit a MIME
attachment as plain text, making it impossible to comment on
your code.  A MIME attachment also takes a bit more time to
process.  This does not decrease the likelihood of your
MIME-attached change being accepted, but it makes it more likely
that it will be postponed.</p>
<p>Exception:  If your mailer is mangling patches then someone may ask
you to re-send them using MIME, that is OK.</p>
<p>Do not PGP sign your patch, at least for now.  Most likely, your
maintainer or other people on the list would not have your PGP
key and would not bother obtaining it anyway.  Your patch is not
judged by who you are; a good patch from an unknown origin has a
far better chance of being accepted than a patch from a known,
respected origin that is done poorly or does incorrect things.</p>
<p>If you really really really really want to do a PGP signed
patch, format it as &#8220;multipart/signed&#8221;, not a text/plain message
that starts with &#8216;&#8212;&#8211;BEGIN PGP SIGNED MESSAGE&#8212;&#8211;&#8217;.  That is
not a text/plain, it&#8217;s something else.</p>
<p>Unless your patch is a very trivial and an obviously correct one,
first send it with &#8220;To:&#8221; set to the mailing list, with &#8220;cc:&#8221; listing
people who are involved in the area you are touching (the output from
&#8220;git blame $path&#8221; and &#8220;git shortlog &#8211;no-merges $path&#8221; would help to
identify them), to solicit comments and reviews.  After the list
reached a consensus that it is a good idea to apply the patch, re-send
it with &#8220;To:&#8221; set to the maintainer and optionally &#8220;cc:&#8221; the list for
inclusion.  Do not forget to add trailers such as &#8220;Acked-by:&#8221;,
&#8220;Reviewed-by:&#8221; and &#8220;Tested-by:&#8221; after your &#8220;Signed-off-by:&#8221; line as
necessary.</p>
</div>
<div class="section" id="sign-your-work">
<h3>Sign your work<a class="headerlink" href="#sign-your-work" title="Permalink to this headline">¶</a></h3>
<p>To improve tracking of who did what, we&#8217;ve borrowed the
&#8220;sign-off&#8221; procedure from the Linux kernel project on patches
that are being emailed around.  Although OfflineIMAP is a lot
smaller project it is a good discipline to follow it.</p>
<p>The sign-off is a simple line at the end of the explanation for
the patch, which <strong>certifies that you wrote it or otherwise have
the right to pass it on as a open-source patch</strong>.  The rules are
pretty simple: if you can certify the below:</p>
<div class="section" id="developer-s-certificate-of-origin-1-1">
<h4><strong>Developer&#8217;s Certificate of Origin 1.1</strong><a class="headerlink" href="#developer-s-certificate-of-origin-1-1" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>By making a contribution to this project, I certify that:</p>
<ol class="loweralpha">
<li><p class="first">The contribution was created in whole or in part by me and I
have the right to submit it under the open source license
indicated in the file; or</p>
</li>
<li><p class="first">The contribution is based upon previous work that, to the best
of my knowledge, is covered under an appropriate open source
license and I have the right under that license to submit that
work with modifications, whether created in whole or in part
by me, under the same open source license (unless I am
permitted to submit under a different license), as indicated
in the file; or</p>
</li>
<li><dl class="first docutils">
<dt>The contribution was provided directly to me by some other</dt>
<dd><p class="first last">person who certified (a), (b) or (c) and I have not modified
it.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>I understand and agree that this project and the contribution</dt>
<dd><p class="first last">are public and that a record of the contribution (including all
personal information I submit with it, including my sign-off) is
maintained indefinitely and may be redistributed consistent with
this project or the open source license(s) involved.</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<p>then you just add a line saying</p>
<blockquote>
<div>Signed-off-by: Random J Developer &lt;<a class="reference external" href="mailto:random&#37;&#52;&#48;developer&#46;example&#46;org">random<span>&#64;</span>developer<span>&#46;</span>example<span>&#46;</span>org</a>&gt;</div></blockquote>
<p>This line can be automatically added by git if you run the git-commit
command with the -s option.</p>
<p>Notice that you can place your own Signed-off-by: line when
forwarding somebody else&#8217;s patch with the above rules for
D-C-O.  Indeed you are encouraged to do so.  Do not forget to
place an in-body &#8220;From: &#8221; line at the beginning to properly attribute
the change to its true author (see above).</p>
<p>Also notice that a real name is used in the Signed-off-by: line. Please
don&#8217;t hide your real name.</p>
<p>If you like, you can put extra tags at the end:</p>
<ul>
<li><dl class="first docutils">
<dt>&#8220;Reported-by:&#8221; is used to to credit someone who found the bug that</dt>
<dd><p class="first last">the patch attempts to fix.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>&#8220;Acked-by:&#8221; says that the person who is more familiar with the area</dt>
<dd><p class="first last">the patch attempts to modify liked the patch.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>&#8220;Reviewed-by:&#8221;, unlike the other tags, can only be offered by the</dt>
<dd><p class="first last">reviewer and means that she is completely satisfied that the patch
is ready for application.  It is usually offered only after a
detailed review.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>&#8220;Tested-by:&#8221; is used to indicate that the person applied the patch</dt>
<dd><p class="first last">and found it to have the desired effect.</p>
</dd>
</dl>
</li>
</ul>
<p>You can also create your own tag or use one that&#8217;s in common usage
such as &#8220;Thanks-to:&#8221;, &#8220;Based-on-patch-by:&#8221;, or &#8220;Mentored-by:&#8221;.</p>
</div>
</div>
</div>
</div>
<div class="section" id="an-ideal-patch-flow">
<h1><a class="toc-backref" href="#id13">An ideal patch flow</a><a class="headerlink" href="#an-ideal-patch-flow" title="Permalink to this headline">¶</a></h1>
<p>Here is an ideal patch flow for this project the current maintainer
suggests to the contributors:</p>
<blockquote>
<div><ol class="arabic" start="0">
<li><p class="first">You come up with an itch.  You code it up.</p>
</li>
<li><p class="first">Send it to the list and cc people who may need to know about
the change.</p>
<p>The people who may need to know are the ones whose code you
are butchering.  These people happen to be the ones who are
most likely to be knowledgeable enough to help you, but
they have no obligation to help you (i.e. you ask for help,
don&#8217;t demand).  <tt class="docutils literal"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">-p</span> <span class="pre">--</span> <span class="pre">$area_you_are_modifying</span></tt> would
help you find out who they are.</p>
</li>
<li><p class="first">You get comments and suggestions for improvements.  You may
even get them in a &#8220;on top of your change&#8221; patch form.</p>
</li>
<li><p class="first">Polish, refine, and re-send to the list and the people who
spend their time to improve your patch.  Go back to step (2).</p>
</li>
<li><p class="first">The list forms consensus that the last round of your patch is
good.  Send it to the list and cc the maintainer.</p>
</li>
<li><p class="first">A topic branch is created with the patch and is merged to &#8216;next&#8217;,
and cooked further and eventually graduates to &#8216;master&#8217;.</p>
</li>
</ol>
</div></blockquote>
<p>In any time between the (2)-(3) cycle, the maintainer may pick it up
from the list and queue it to &#8216;pu&#8217;, in order to make it easier for
people play with it without having to pick up and apply the patch to
their trees themselves.</p>
<div class="section" id="know-the-status-of-your-patch-after-submission">
<h2><a class="toc-backref" href="#id14">Know the status of your patch after submission</a><a class="headerlink" href="#know-the-status-of-your-patch-after-submission" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>You can use Git itself to find out when your patch is merged in
master. <tt class="docutils literal"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">--rebase</span></tt> will automatically skip already-applied
patches, and will let you know. This works only if you rebase on top
of the branch in which your patch has been merged (i.e. it will not
tell you if your patch is merged in pu if you rebase on top of
master).</li>
</ul>
</div>
</div>
<div class="section" id="mua-specific-hints">
<h1><a class="toc-backref" href="#id15">MUA specific hints</a><a class="headerlink" href="#mua-specific-hints" title="Permalink to this headline">¶</a></h1>
<p>Some of patches I receive or pick up from the list share common
patterns of breakage.  Please make sure your MUA is set up
properly not to corrupt whitespaces.  Here are two common ones
I have seen:</p>
<ul class="simple">
<li>Empty context lines that do not have _any_ whitespace.</li>
<li>Non empty context lines that have one extra whitespace at the
beginning.</li>
</ul>
<p>One test you could do yourself if your MUA is set up correctly is:</p>
<ul>
<li><p class="first">Send the patch to yourself, exactly the way you would, except
To: and Cc: lines, which would not contain the list and
maintainer address.</p>
</li>
<li><p class="first">Save that patch to a file in UNIX mailbox format.  Call it say
a.patch.</p>
</li>
<li><p class="first">Try to apply to the tip of the &#8220;master&#8221; branch from the
git.git public repository:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git fetch http://kernel.org/pub/scm/git/git.git master:test-apply
$ git checkout test-apply
$ git reset --hard
$ git am a.patch
</pre></div>
</div>
</li>
</ul>
<p>If it does not apply correctly, there can be various reasons.</p>
<ul class="simple">
<li>Your patch itself does not apply cleanly.  That is _bad_ but
does not have much to do with your MUA.  Please rebase the
patch appropriately.</li>
<li>Your MUA corrupted your patch; &#8220;am&#8221; would complain that
the patch does not apply.  Look at .git/rebase-apply/ subdirectory and
see what &#8216;patch&#8217; file contains and check for the common
corruption patterns mentioned above.</li>
<li>While you are at it, check what are in &#8216;info&#8217; and
&#8216;final-commit&#8217; files as well.  If what is in &#8216;final-commit&#8217; is
not exactly what you would want to see in the commit log
message, it is very likely that your maintainer would end up
hand editing the log message when he applies your patch.
Things like &#8220;Hi, this is my first patch.n&#8221;, if you really
want to put in the patch e-mail, should come after the
three-dash line that signals the end of the commit message.</li>
</ul>
<div class="section" id="pine">
<h2><a class="toc-backref" href="#id16">Pine</a><a class="headerlink" href="#pine" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>(Johannes Schindelin)</dt>
<dd><p class="first">I don&#8217;t know how many people still use pine, but for those poor souls it may
be good to mention that the quell-flowed-text is needed for recent versions.</p>
<p class="last">... the &#8220;no-strip-whitespace-before-send&#8221; option, too. AFAIK it was introduced
in 4.60.</p>
</dd>
<dt>(Linus Torvalds)</dt>
<dd>And 4.58 needs at least this</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre>---
diff-tree 8326dd8350be64ac7fc805f6563a1d61ad10d32c (from e886a61f76edf5410573e92e38ce22974f9c40f1)
Author: Linus Torvalds &lt;torvalds@g5.osdl.org&gt;
Date:   Mon Aug 15 17:23:51 2005 -0700

    Fix pine whitespace-corruption bug

    There&#39;s no excuse for unconditionally removing whitespace from
    the pico buffers on close.

diff --git a/pico/pico.c b/pico/pico.c
--- a/pico/pico.c
+++ b/pico/pico.c
@@ -219,7 +219,9 @@ PICO *pm;
          switch(pico_all_done){      /* prepare for/handle final events */
            case COMP_EXIT :          /* already confirmed */
              packheader();
+#if 0
              stripwhitespace();
+#endif
              c |= COMP_EXIT;
              break;
</pre></div>
</div>
<dl class="docutils">
<dt>(Daniel Barkalow)</dt>
<dd><p class="first">&gt; A patch to SubmittingPatches, MUA specific help section for
&gt; users of Pine 4.63 would be very much appreciated.</p>
<p class="last">Ah, it looks like a recent version changed the default behavior to do the
right thing, and inverted the sense of the configuration option. (Either
that or Gentoo did it.) So you need to set the
&#8220;no-strip-whitespace-before-send&#8221; option, unless the option you have is
&#8220;strip-whitespace-before-send&#8221;, in which case you should avoid checking
it.</p>
</dd>
</dl>
</div>
<div class="section" id="thunderbird">
<h2><a class="toc-backref" href="#id17">Thunderbird</a><a class="headerlink" href="#thunderbird" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>(A Large Angry SCM)</dt>
<dd><p class="first">By default, Thunderbird will both wrap emails as well as flag them as
being &#8216;format=flowed&#8217;, both of which will make the resulting email unusable
by git.</p>
<p>Here are some hints on how to successfully submit patches inline using
Thunderbird.</p>
<p class="last">There are two different approaches.  One approach is to configure
Thunderbird to not mangle patches.  The second approach is to use
an external editor to keep Thunderbird from mangling the patches.</p>
</dd>
</dl>
<p><strong>Approach #1 (configuration):</strong></p>
<blockquote>
<div><p>This recipe is current as of Thunderbird 2.0.0.19.  Three steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Configure your mail server composition as plain text
Edit...Account Settings...Composition &amp; Addressing,
uncheck &#8216;Compose Messages in HTML&#8217;.</li>
<li>Configure your general composition window to not wrap
Edit..Preferences..Composition, wrap plain text messages at 0</li>
<li>Disable the use of format=flowed
Edit..Preferences..Advanced..Config Editor.  Search for:
mailnews.send_plaintext_flowed
toggle it to make sure it is set to &#8216;false&#8217;.</li>
</ol>
</div></blockquote>
<p>After that is done, you should be able to compose email as you
otherwise would (cut + paste, git-format-patch | git-imap-send, etc),
and the patches should not be mangled.</p>
</div></blockquote>
<p><strong>Approach #2 (external editor):</strong></p>
<p>This recipe appears to work with the current [<em>1</em>] Thunderbird from Suse.</p>
<dl class="docutils">
<dt>The following Thunderbird extensions are needed:</dt>
<dd><dl class="first last docutils">
<dt>AboutConfig 0.5</dt>
<dd><a class="reference external" href="http://aboutconfig.mozdev.org/">http://aboutconfig.mozdev.org/</a></dd>
<dt>External Editor 0.7.2</dt>
<dd><a class="reference external" href="http://globs.org/articles.php?lng=en&amp;pg=8">http://globs.org/articles.php?lng=en&amp;pg=8</a></dd>
</dl>
</dd>
</dl>
<ol class="arabic">
<li><p class="first">Prepare the patch as a text file using your method of choice.</p>
</li>
<li><p class="first">Before opening a compose window, use Edit-&gt;Account Settings to
uncheck the &#8220;Compose messages in HTML format&#8221; setting in the
&#8220;Composition &amp; Addressing&#8221; panel of the account to be used to send the
patch. [<em>2</em>]</p>
</li>
<li><p class="first">In the main Thunderbird window, _before_ you open the compose window
for the patch, use Tools-&gt;about:config to set the following to the
indicated values:</p>
<div class="highlight-python"><div class="highlight"><pre>mailnews.send_plaintext_flowed     =&gt; false
mailnews.wraplength                =&gt; 0
</pre></div>
</div>
</li>
<li><p class="first">Open a compose window and click the external editor icon.</p>
</li>
<li><p class="first">In the external editor window, read in the patch file and exit the
editor normally.</p>
</li>
<li><p class="first">Back in the compose window: Add whatever other text you wish to the
message, complete the addressing and subject fields, and press send.</p>
</li>
<li><p class="first">Optionally, undo the <a class="reference external" href="about:config/account">about:config/account</a> settings changes made in
steps 2 &amp; 3.</p>
</li>
</ol>
<p>[Footnotes]</p>
<p><em>1</em> Version 1.0 (20041207) from the MozillaThunderbird-1.0-5 rpm of Suse
9.3 professional updates.</p>
<p><em>2</em> It may be possible to do this with <a class="reference external" href="about:config">about:config</a> and the following
settings but I haven&#8217;t tried, yet:</p>
<div class="highlight-python"><div class="highlight"><pre>mail.html_compose                     =&gt; false
mail.identity.default.compose_html    =&gt; false
mail.identity.id?.compose_html                =&gt; false
</pre></div>
</div>
<dl class="docutils">
<dt>(Lukas Sandström)</dt>
<dd>There is a script in contrib/thunderbird-patch-inline which can help you
include patches with Thunderbird in an easy way. To use it, do the steps above
and then use the script as the external editor.</dd>
</dl>
</div>
<div class="section" id="gnus">
<h2><a class="toc-backref" href="#id18">Gnus</a><a class="headerlink" href="#gnus" title="Permalink to this headline">¶</a></h2>
<p>&#8216;|&#8217; in the <em>Summary</em> buffer can be used to pipe the current
message to an external program, and this is a handy way to drive
&#8220;git am&#8221;.  However, if the message is MIME encoded, what is
piped into the program is the representation you see in your
<em>Article</em> buffer after unwrapping MIME.  This is often not what
you would want for two reasons.  It tends to screw up non ASCII
characters (most notably in people&#8217;s names), and also
whitespaces (fatal in patches).  Running &#8216;C-u g&#8217; to display the
message in raw form before using &#8216;|&#8217; to run the pipe can work
this problem around.</p>
</div>
<div class="section" id="kmail">
<h2><a class="toc-backref" href="#id19">KMail</a><a class="headerlink" href="#kmail" title="Permalink to this headline">¶</a></h2>
<p>This should help you to submit patches inline using KMail.</p>
<ol class="arabic simple">
<li>Prepare the patch as a text file.</li>
<li>Click on New Mail.</li>
<li>Go under &#8220;Options&#8221; in the Composer window and be sure that
&#8220;Word wrap&#8221; is not set.</li>
<li>Use Message -&gt; Insert file... and insert the patch.</li>
<li>Back in the compose window: add whatever other text you wish to the
message, complete the addressing and subject fields, and press send.</li>
</ol>
</div>
<div class="section" id="gmail">
<h2><a class="toc-backref" href="#id20">Gmail</a><a class="headerlink" href="#gmail" title="Permalink to this headline">¶</a></h2>
<p>GMail does not appear to have any way to turn off line wrapping in the web
interface, so this will mangle any emails that you send.  You can however
use &#8220;git send-email&#8221; and send your patches through the GMail SMTP server, or
use any IMAP email client to connect to the google IMAP server and forward
the emails through that.</p>
<p>To use <tt class="docutils literal"><span class="pre">git</span> <span class="pre">send-email</span></tt> and send your patches through the GMail SMTP server,
edit <cite>~/.gitconfig</cite> to specify your account settings:</p>
<div class="highlight-python"><div class="highlight"><pre>[sendemail]
        smtpencryption = tls
        smtpserver = smtp.gmail.com
        smtpuser = user@gmail.com
        smtppass = p4ssw0rd
        smtpserverport = 587
</pre></div>
</div>
<p>Once your commits are ready to be sent to the mailing list, run the
following commands:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git format-patch --cover-letter -M origin/master -o outgoing/
$ edit outgoing/0000-*
$ git send-email outgoing/*
</pre></div>
</div>
<p>To submit using the IMAP interface, first, edit your <cite>~/.gitconfig</cite> to specify your
account settings:</p>
<div class="highlight-python"><div class="highlight"><pre>[imap]
        folder = &quot;[Gmail]/Drafts&quot;
        host = imaps://imap.gmail.com
        user = user@gmail.com
        pass = p4ssw0rd
        port = 993
        sslverify = false
</pre></div>
</div>
<p>You might need to instead use: folder = &#8220;[Google Mail]/Drafts&#8221; if you get an error
that the &#8220;Folder doesn&#8217;t exist&#8221;.</p>
<p>Once your commits are ready to be sent to the mailing list, run the
following commands:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git format-patch --cover-letter -M --stdout origin/master | git imap-send
</pre></div>
</div>
<p>Just make sure to disable line wrapping in the email client (GMail web
interface will line wrap no matter what, so you need to use a real
IMAP client).</p>
</div>
</div>
<div class="section" id="working-with-git">
<h1><a class="toc-backref" href="#id21">Working with Git</a><a class="headerlink" href="#working-with-git" title="Permalink to this headline">¶</a></h1>
<div class="section" id="extract-a-topic-from-pu">
<h2><a class="toc-backref" href="#id22">Extract a topic from pu</a><a class="headerlink" href="#extract-a-topic-from-pu" title="Permalink to this headline">¶</a></h2>
<p>pu is built this way:</p>
<div class="highlight-python"><div class="highlight"><pre>git checkout pu
git reset --keep next
git merge --no-ff -X theirs topic1
git merge --no-ff -X theirs topic2
git merge --no-ff -X theirs blue
git merge --no-ff -X theirs orange
...
</pre></div>
</div>
<p>As a consequence:</p>
<ol class="arabic simple">
<li>Each topic merged uses a merge commit. A merge commit is a commit having 2
ancestors. Actually, Git allows more than 2 parents but we don&#8217;t use this
feature. It&#8217;s intended.</li>
<li>Paths in pu may mix up multiple versions if all the topics don&#8217;t use the same
base commit. This is very often the case as topics aren&#8217;t rebased: it guarantees
each topic is strictly identical to the last version sent to the mailing list.
No surprise.</li>
</ol>
<p>What you need to extract a particular topic is the sha1 of the tip of that
branch (the last commit of the topic). Assume you want the branch of the topic
called &#8216;blue&#8217;. First, look at the log given by this command:</p>
<div class="highlight-python"><div class="highlight"><pre>git log --reverse --merges --parents origin/next..origin/pu
</pre></div>
</div>
<p>With this command you ask for the log:</p>
<ul class="simple">
<li>from next to pu</li>
<li>in reverse order (older first)</li>
<li>merge commits only</li>
<li>with the sha1 of the ancestors</li>
</ul>
<p>In this list, find the topic you&#8217;re looking for, basing you search on the lines
like:</p>
<div class="highlight-python"><div class="highlight"><pre>Merge branch &#39;topic/name&#39; into pu
</pre></div>
</div>
<p>By convention, it has the form &lt;author_initials&gt;/&lt;brief_title&gt;. When you&#8217;re at
it, pick the topic ancestor sha1. It&#8217;s always the last sha1 in the line starting
by &#8216;commit&#8217;. For you to know:</p>
<ul class="simple">
<li>the first is the sha1 of the commit you see: the merge commit</li>
<li>the following sha1 is the ancestor of the branch checkouted at merge time
(always the previous merged topic or the ancien next in our case)</li>
<li>last is the branch merged</li>
</ul>
<p>Giving:</p>
<div class="highlight-python"><div class="highlight"><pre>commit sha1_of_merge_commit sha1_of_ancient_pu sha1_of_topic_blue
</pre></div>
</div>
<p>Then, you only have to checkout the topic from there:</p>
<div class="highlight-python"><div class="highlight"><pre>git checkout -b blue sha1_of_topic_blue
</pre></div>
</div>
<p>and you&#8217;re done! You&#8217;ve just created a new branch called &#8220;blue&#8221; with the blue
content. Be aware this topic is almostly not updated against current next
branch. ,-)</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Hacking OfflineIMAP</a><ul>
<li><a class="reference internal" href="#api">API</a></li>
<li><a class="reference internal" href="#following-new-commits">Following new commits</a></li>
</ul>
</li>
<li><a class="reference internal" href="#git-offlineimap-s-branching-model-and-workflow">Git: OfflineImap&#8217;s branching Model And Workflow</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#git-branching-model">Git Branching model</a><ul>
<li><a class="reference internal" href="#master">master</a></li>
<li><a class="reference internal" href="#next">next</a></li>
<li><a class="reference internal" href="#pu">pu</a></li>
<li><a class="reference internal" href="#maint">maint</a></li>
</ul>
</li>
<li><a class="reference internal" href="#release-cycles">Release cycles</a></li>
<li><a class="reference internal" href="#tagging-release-or-rc">Tagging release or RC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#contribution-checklist-and-a-short-version-for-the-impatient">Contribution Checklist (and a short version for the impatient)</a><ul>
<li><a class="reference internal" href="#create-commits">Create commits</a></li>
<li><a class="reference internal" href="#export-commits-as-patches">Export commits as patches</a></li>
<li><a class="reference internal" href="#long-version">Long version</a><ul>
<li><a class="reference internal" href="#decide-what-branch-to-base-your-work-on">Decide what branch to base your work on</a></li>
<li><a class="reference internal" href="#make-separate-commits-for-logically-separate-changes">Make separate commits for logically separate changes</a></li>
<li><a class="reference internal" href="#generate-your-patch-using-git-tools-out-of-your-commits">Generate your patch using git tools out of your commits</a></li>
<li><a class="reference internal" href="#sending-your-patches">Sending your patches</a></li>
<li><a class="reference internal" href="#sign-your-work">Sign your work</a><ul>
<li><a class="reference internal" href="#developer-s-certificate-of-origin-1-1"><strong>Developer&#8217;s Certificate of Origin 1.1</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#an-ideal-patch-flow">An ideal patch flow</a><ul>
<li><a class="reference internal" href="#know-the-status-of-your-patch-after-submission">Know the status of your patch after submission</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mua-specific-hints">MUA specific hints</a><ul>
<li><a class="reference internal" href="#pine">Pine</a></li>
<li><a class="reference internal" href="#thunderbird">Thunderbird</a></li>
<li><a class="reference internal" href="#gnus">Gnus</a></li>
<li><a class="reference internal" href="#kmail">KMail</a></li>
<li><a class="reference internal" href="#gmail">Gmail</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-git">Working with Git</a><ul>
<li><a class="reference internal" href="#extract-a-topic-from-pu">Extract a topic from pu</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="FAQ.html"
                        title="previous chapter">1&nbsp;&nbsp;&nbsp;OfflineIMAP FAQ (Frequently Asked Questions)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="API.html"
                        title="next chapter"><tt class="docutils literal"><span class="pre">offlineimap's</span></tt> API documentation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/HACKING.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="API.html" title="offlineimap&#39;s API documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="FAQ.html" title="1   OfflineIMAP FAQ (Frequently Asked Questions)"
             >previous</a> |</li>
        <li><a href="index.html">OfflineImap 6.5.6.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2002-2010, John Goerzen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>